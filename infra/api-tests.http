### Variables
@baseUrl = http://localhost:8090
@username = john.doe
@email = john.doe@example.com
@password = SecurePass123!
@token = 5dcd494a-97e5-427e-91f4-6a174c5fd6a8

### 1. Register User
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "username": "{{username}}",
  "email": "{{email}}",
  "password": "{{password}}",
  "organisation": "JohnDoe Labs",
  "terms": true,
  "marketing": false
}

### 2. Confirm Account
GET {{baseUrl}}/api/auth/confirm-account?token={{token}}

### 3. Login
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "login": "{{email}}",
  "password": "{{password}}",
  "rememberMe": false
}

### 4. Login with Remember Me
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "login": "{{email}}",
  "password": "{{password}}",
  "rememberMe": true
}

### 5. Logout
POST {{baseUrl}}/api/auth/logout

### 6. Forgot Password
POST {{baseUrl}}/api/auth/forgot-password
Content-Type: application/json

{
  "email": "{{email}}"
}

### 7. Confirm Password Token
GET {{baseUrl}}/api/auth/confirm-password-token?token={{token}}

### 8. Reset Password
POST {{baseUrl}}/api/auth/reset-password
Content-Type: application/json

{
  "token": "{{token}}",
  "newPassword": "NewSecurePass123!"
}

### 9. Resend Verification
POST {{baseUrl}}/api/auth/resend-verification
Content-Type: application/json

{
  "email": "{{email}}"
}

### OAuth2 Tests

### 10. Get Google Authorization URL
GET {{baseUrl}}/api/auth/oauth2/authorization-url/google
Content-Type: application/json

### 11. Test OAuth2 Manual Flow (Open in Browser)
# Visit this URL in browser to test the full OAuth2 flow
# {{baseUrl}}/oauth2/authorization/google

### 12. Test OAuth2 Error Handling - Invalid Provider
GET {{baseUrl}}/oauth2/authorization/invalid-provider

### 13. Test Session Info After OAuth2 Login
GET {{baseUrl}}/api/session/info

### 14. Test All Sessions After OAuth2 Login
GET {{baseUrl}}/api/session/all

### 15. Test OAuth2 User Can Access Protected Endpoint
GET {{baseUrl}}/api/session/validate

### 16. Test OAuth2 Rate Limiting (Run multiple times quickly)
GET {{baseUrl}}/api/auth/oauth2/authorization-url/google

### 17. Test CSRF Token Endpoint
GET {{baseUrl}}/api/auth/csrf-token

### 18. Test OAuth2 with Email Conflict
# First register with email/password, then try OAuth2 with same email
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "username": "testuser",
  "email": "test@gmail.com",
  "password": "SecurePass123!",
  "terms": true,
  "marketing": false
}

### 19. Performance Test - Multiple OAuth2 Authorization Requests
GET {{baseUrl}}/api/auth/oauth2/authorization-url/google
GET {{baseUrl}}/api/auth/oauth2/authorization-url/google
GET {{baseUrl}}/api/auth/oauth2/authorization-url/google